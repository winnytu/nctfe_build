(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01f7ec6c"],{"0373":function(t,e,s){"use strict";s("70cd")},"10d5":function(t,e,s){t.exports=s.p+"img/doll.dafb77ce.jpeg"},"5a7c":function(t,e,s){"use strict";s("d1f9")},"5c0d":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"together-item-container"},[s("div",{staticClass:"together-item-row"},t._l(t.itemList,(function(e,i){return s("div",{key:i,staticClass:"together-item-wrapper",on:{click:function(s){return t.openTogetherDetail(e)}}},[t.isApply?s("div",{staticClass:"together-item"},[s("div",{staticClass:"img-container"},[s("img",{attrs:{src:e.img?e.togetherInfo.img:t.defaultimg,alt:""}})]),s("div",{staticClass:"category-container"},[s("p",{staticClass:"group"},[s("span",{staticClass:"category"},[t._v(t._s(e.togetherInfo.category))]),s("span",{staticClass:"group-name"},[t._v(t._s(e.groupName))])]),s("div",{staticClass:"date"},[t._v("期限 "+t._s(e.togetherInfo.expired_time))])]),s("div",{staticClass:"title"},[t._v("\n\t\t\t\t\t\t"+t._s(e.togetherInfo.itemTitle)+"\n\t\t\t\t\t")]),s("div",{staticClass:"desc"},[t._v("缺 "),t._l(e.togetherInfo.itemList,(function(e,i){return s("span",{key:i},[e[1]>0?s("span",[t._v(t._s(e[0])+" ")]):t._e()])}))],2),s("div",{staticClass:"user"},[t._m(1,!0),s("div",{staticClass:"loginname"},[t._v(t._s(e.togetherInfo.creator))])])]):s("div",{staticClass:"together-item"},[s("div",{staticClass:"img-container"},[s("img",{attrs:{src:e.img?e.img:t.defaultimg,alt:""}})]),s("div",{staticClass:"category-container"},[s("p",{staticClass:"group"},[s("span",{staticClass:"category"},[t._v(t._s(e.category))]),s("span",{staticClass:"group-name"},[t._v(t._s(e.groupName))])]),s("div",{staticClass:"date"},[t._v("期限 "+t._s(e.expired_time))])]),s("div",{staticClass:"title"},[t._v("\n\t\t\t\t\t\t"+t._s(e.itemTitle)+"\n\t\t\t\t\t")]),s("div",{staticClass:"desc"},[t._v("缺 "),t._l(e.itemListA.concat(e.itemListB),(function(e,i){return s("span",{key:i},[e[1]>0?s("span",[t._v(t._s(e[0])+" ")]):t._e()])}))],2),s("div",{staticClass:"user"},[t._m(0,!0),s("div",{staticClass:"loginname"},[t._v(t._s(e.creator))])])])])})),0)]),s("togetherDetail",{attrs:{showDialog:t.showTogetherDetail,curItem:t.curItem},on:{"update:showDialog":function(e){t.showTogetherDetail=e},"update:show-dialog":function(e){t.showTogetherDetail=e},success:t.success}}),s("togetherMessage",{attrs:{showDialog:t.showExchangeMessage,togetherItem:t.curItem},on:{"update:showDialog":function(e){t.showExchangeMessage=e},"update:show-dialog":function(e){t.showExchangeMessage=e}}})],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"img"},[i("img",{attrs:{src:s("18d5"),alt:""}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"img"},[i("img",{attrs:{src:s("18d5"),alt:""}})])}],r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showDialog?s("el-dialog",{staticClass:"message-center",attrs:{visible:t.showDialog,width:"1100"},on:{close:function(e){return t.onClose()}}},[s("div",{staticClass:"msg-container"},[t.applyList&&t.applyList.length>0?s("div",{staticClass:"msg-list"},[s("div",{staticClass:"title"},[t._v("\n            申請列表\n        ")]),t._v("\n        \b"),t._l(t.applyList,(function(e,i){return s("div",{key:i,staticClass:"msg-list-item"},[s("div",{staticClass:"msg",class:{active:t.curItem.applier==e.applier},on:{click:function(s){return t.selectItem(e)}}},[s("p",{staticClass:"applier"},[t._v(t._s(e.applier))]),s("div",{staticClass:"member"},[t._l(e.ownMember,(function(e){return s("span",{key:e,staticClass:"member"},[t._v(t._s(e))])})),t._v("\n                    換\n                    "),t._l(e.targetMember,(function(e,i){return s("span",{key:i,staticClass:"member"},[t._v(t._s(e)+" ")])}))],2),s("p",{staticClass:"date"},[t._v(t._s(e.create_time))])])])}))],2):s("div",{staticClass:"nodata"},[s("p",[t._v("無申請資料")])]),t.applyList&&t.applyList.length>0?s("div",{staticClass:"msg-box"},[s("div",{staticClass:"title"},[t.curMessageList.length>0?s("p",[t._v(t._s(t.curMessageList[0].fromUser==t.userName?t.curMessageList[0].toUser:t.curMessageList[0].fromUser))]):t._e()]),s("div",{staticClass:"msg-detail-container"},t._l(t.curMessageList,(function(e,i){return s("div",{key:i,staticClass:"msg-detail",class:{self:e.fromUser==t.userName}},[s("div",{staticClass:"text"},[t._v(t._s(e.postMessage))]),s("div",{staticClass:"date"},[t._v(t._s(e.create_time))])])})),0),s("div",{staticClass:"msg-send"},[s("el-input",{staticClass:"type-box",attrs:{autosize:"",maxlength:"100",type:"textarea","show-word-limit":"",placeholder:"輸入訊息"},model:{value:t.msgText,callback:function(e){t.msgText=e},expression:"msgText"}}),s("el-button",{staticClass:"btn-send",on:{click:function(e){return t.doSendMessage()}}},[t._v("送出")])],1)]):t._e(),s("div",{staticClass:"msg-info"},[s("div",{staticClass:"title"},[t._v("\n            物品資訊\n        ")]),s("div",{staticClass:"info-container"},[s("div",{staticClass:"img-container"},[s("img",{attrs:{src:t.togetherItem.img?t.togetherItem.img:t.defaultimg}})]),s("div",{staticClass:"category-group"},[s("p",{staticClass:"category"},[t._v(t._s(t.togetherItem.category))]),"專卡"===t.togetherItem.category?s("p",{staticClass:"album"},[t._v(t._s(t.togetherItem.groupName)+" "+t._s(t.togetherItem.album))]):t._e()]),s("p",{staticClass:"member"},[t._l(t.togetherItem.ownMember,(function(e){return s("span",{key:e},[t._v(t._s(e)+" ")])})),t._v(" 換 "),t._l(t.togetherItem.targetMember,(function(e,i){return s("span",{key:i},[t._v(t._s(e)+" ")])}))],2),s("p",{staticClass:"desc"},[t._v(t._s(t.togetherItem.desc))]),s("p",{staticClass:"note"},t._l(t.togetherItem.note,(function(e){return s("span",{key:e},[t._v("#"+t._s(e)+" ")])})),0)])])])]):t._e()},c=[],o=(s("8e6e"),s("ac6a"),s("456d"),s("96cf"),s("3b8d")),n=s("bd86"),l=s("2f62"),u=s("55b3"),m=s("c443");function p(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function g(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?p(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var h={props:{showDialog:{type:Boolean,require:!0},togetherItem:{}},data:function(){return{applyList:[],myExchangeList:[],defaultimg:s("1de5"),curItemId:"",curItem:{},msgText:"",curMessageType:"my",curMessageList:[],curMessageTypeList:[]}},computed:g({},Object(l["c"])({userImg:function(t){return t.user.userImg},userName:function(t){return t.user.userName}})),watch:{showDialog:function(t){t&&this.getApplyListFunc()}},mounted:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),methods:{getApplyListFunc:function(){var t=this;Object(u["c"])({itemId:this.togetherItem.itemId}).then((function(e){console.log(e),t.applyList=e.messageList,t.selectItem(t.applyList[0])})).catch((function(t){console.log(t)}))},selectItem:function(t){this.curItemId=t.itemId,this.curItem=t,this.getItemMessage()},getItemMessage:function(){var t=this,e={itemId:this.curItemId,applier:this.curItem.applier,creator:this.togetherItem.creator};Object(m["c"])(e).then((function(e){console.log(e),t.curMessageList=e.messageList})).catch((function(t){console.log(t)}))},doSendMessage:function(){var t=this,e=this.curMessageList[0],s={postMessage:this.msgText,fromUser:this.userName,toUser:e.fromUser!==this.userName?e.fromUser:e.toUser,relatedItem:e.relatedItem};console.log(s),Object(m["d"])(s).then((function(e){t.getItemMessage(),t.msgText=""})).catch((function(t){console.log(t)}))},onClose:function(){this.$emit("update:showDialog",!1)}}},f=h,d=(s("5a7c"),s("2877")),v=Object(d["a"])(f,r,c,!1,null,"545c5326",null),_=v.exports,y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.showDialog?s("el-dialog",{staticClass:"together-detail",attrs:{visible:t.showDialog,width:"1000"},on:{close:function(e){return t.onClose()}}},[s("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[t._v("\n            "+t._s(1==t.step?"交換物品詳情":"交換資訊確認")+"\n        ")]),1==t.step?s("div",{staticClass:"item-info"},[s("div",{staticClass:"img-container"},[s("img",{attrs:{src:t.curItem.img?t.curItem.img:t.defaultimg,alt:""}})]),s("div",{staticClass:"category-group"},[s("p",{staticClass:"category"},[t._v(t._s(t.curItem.category))]),s("p",{staticClass:"group-name"},[t._v(t._s(t.curItem.groupName))])]),s("div",{staticClass:"item-title"},[t._v(t._s(t.curItem.itemTitle))]),s("div",{staticClass:"desc"},[t._v(t._s(t.curItem.desc))]),s("p",{staticClass:"note"},[t._v("主揪 "+t._s(t.curItem.creator)+" 截止日期 "+t._s(t.curItem.expired_time))]),s("el-form",{staticClass:"apply-form"},["C"===t.curItem.rule||"D"===t.curItem.rule?s("p",[t._v("多帶區")]):t._e(),s("el-checkbox-group",{model:{value:t.checkListA,callback:function(e){t.checkListA=e},expression:"checkListA"}},t._l(t.curItem.itemListA,(function(e,i){return s("div",{key:i},[e[1]>0?s("el-checkbox",{attrs:{label:e}},[s("p",[t._v(t._s(e[0])+" - "+t._s(e[2])+"/1")]),t.checkListA.find((function(t){return t[0]===e[0]}))?s("el-select",{attrs:{placeholder:"请選擇數量"},on:{change:function(e){return t.selectNum(i)}},model:{value:t.curNum[i],callback:function(e){t.$set(t.curNum,i,e)},expression:"curNum[i]"}},t._l(Number(e[1]),(function(t,e){return s("el-option",{key:e,attrs:{value:t}})})),1):t._e()],1):t._e()],1)})),0)],1),"C"===t.curItem.rule||"D"===t.curItem.rule?s("el-form",{staticClass:"apply-form"},[s("p",[t._v("單帶區")]),s("el-checkbox-group",{model:{value:t.checkListB,callback:function(e){t.checkListB=e},expression:"checkListB"}},t._l(t.curItem.itemListB,(function(e,i){return s("div",{key:i},[e[1]>0?s("el-checkbox",{attrs:{label:e}},[s("p",[t._v(t._s(e[0])+" - "+t._s(e[2])+"/1")]),t.checkListB.find((function(t){return t[0]===e[0]}))?s("el-select",{attrs:{placeholder:"请選擇數量"},on:{change:function(e){return t.selectNum(i)}},model:{value:t.curNum[i],callback:function(e){t.$set(t.curNum,i,e)},expression:"curNum[i]"}},t._l(Number(e[1]),(function(t,e){return s("el-option",{key:e,attrs:{value:t}})})),1):t._e()],1):t._e()],1)})),0)],1):t._e()],1):t._e(),2==t.step?s("div",{staticClass:"check-form"},[s("p",[s("span",{staticClass:"form-title"},[t._v("交換物品")]),s("span",{staticClass:"category"},[t._v(t._s(t.curItem.itemTitle))])]),s("p",[s("span",{staticClass:"form-title"},[t._v("擁有成員")])]),s("p",{staticClass:"form-title"},[t._v("填寫交換訊息")]),s("el-input",{attrs:{type:"textarea",placeholder:"請填入訊息"},model:{value:t.message.postMessage,callback:function(e){t.$set(t.message,"postMessage",e)},expression:"message.postMessage"}}),s("div",{staticClass:"warning-text"},[s("i",{staticClass:"el-icon-warning"}),t._v("點擊送出即提交申請，若隨意取消交易可能會影響您的評價")])],1):t._e(),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){return t.onClose()}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit()}}},[t._v(t._s(1==t.step?"下一步":"確認送出"))])],1)]):t._e()},I=[];function b(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function C(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?b(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):b(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var L={props:{showDialog:{type:Boolean,require:!0},curItem:{}},data:function(){return{step:1,defaultimg:s("10d5"),checkListA:[],checkListB:[],curNum:[],applyListA:[],applyListB:[],form:{msg:""},message:{fromUser:this.userName,toUser:this.curItem?this.curItem.creator:"",relatedItem:this.curItem?this.curItem.itemId:"",postMessage:""}}},computed:C({},Object(l["c"])({userImg:function(t){return t.user.userImg},userName:function(t){return t.user.userName}})),watch:{showDialog:function(t){t&&(this.checkListA=[],this.checkListB=[],this.curNum=[],this.applyListA=JSON.parse(JSON.stringify(this.curItem.itemListA)),this.applyListB=JSON.parse(JSON.stringify(this.curItem.itemListB)),this.step=1,this.message={fromUser:this.userName,toUser:this.curItem?this.curItem.creator:"",relatedItem:this.curItem?this.curItem.itemId:"",postMessage:""})}},methods:{onClose:function(){this.$emit("update:showDialog",!1)},selectNum:function(t){this.applyListA[t][1]=this.curNum[t]},submit:function(){var t=this;if(1!=this.step){var e={itemId:this.curItem.itemId,itemListA:this.applyListA,itemListB:this.applyListB,applier:this.userName,message:this.message};Object(u["a"])(e).then((function(e){console.log(e.data),t.$emit("success")})).catch((function(t){console.log(t)})),this.$emit("update:showDialog",!1)}else{this.step=2;for(var s="",i=0;i<this.applyListA.length;i++)this.applyListA[i][1]===this.curItem.itemListA[i][1]&&(this.applyListA[i][1]=0),this.applyListA[i][1]>0&&(s+="".concat(this.applyListA[i][0],"x").concat(this.applyListA[i][1]));for(var a=0;a<this.applyListB.length;a++)this.applyListB[a][1]===this.curItem.itemListB[a][1]&&(this.applyListB[a][1]=0),this.applyListB[a][1]>0&&(s+="".concat(this.applyListB[a][0],"x").concat(this.applyListB[a][1]));this.message.postMessage="您好，想拆售".concat(s,"，謝謝")}}}},w=L,O=(s("0373"),Object(d["a"])(w,y,I,!1,null,"5b405e24",null)),k=O.exports,x={name:"togetherItem",components:{togetherDetail:k,togetherMessage:_},props:{itemList:{type:Array,default:[]},isList:{type:Boolean,default:!0},isApply:{type:Boolean,default:!1}},data:function(){return{curItem:null,defaultimg:s("10d5"),showTogetherDetail:!1,showExchangeMessage:!1}},methods:{openTogetherDetail:function(t){this.isApply?this.curItem=t.togetherInfo:this.curItem=t,this.isList?this.showTogetherDetail=!0:this.showExchangeMessage=!0},success:function(){this.$emit("success")}}},j=x,D=(s("734b"),Object(d["a"])(j,i,a,!1,null,"121ac140",null));e["a"]=D.exports},"70cd":function(t,e,s){},"734b":function(t,e,s){"use strict";s("8bab")},"8bab":function(t,e,s){},d1f9:function(t,e,s){}}]);
//# sourceMappingURL=chunk-01f7ec6c.a31ee39c.js.map