(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ec6dae40"],{"0a49":function(e,t,s){var r=s("9b43"),n=s("626a"),i=s("4bf8"),c=s("9def"),a=s("cd1c");e.exports=function(e,t){var s=1==e,o=2==e,u=3==e,l=4==e,m=6==e,f=5==e||m,d=t||a;return function(t,a,g){for(var h,p,v=i(t),y=n(v),b=r(a,g,3),I=c(y.length),_=0,x=s?d(t,I):o?d(t,0):void 0;I>_;_++)if((f||_ in y)&&(h=y[_],p=b(h,_,v),e))if(s)x[_]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return _;case 2:x.push(h)}else if(l)return!1;return m?-1:u||l?l:x}}},1169:function(e,t,s){var r=s("2d95");e.exports=Array.isArray||function(e){return"Array"==r(e)}},2204:function(e,t,s){"use strict";s("577c")},"577c":function(e,t,s){},7514:function(e,t,s){"use strict";var r=s("5ca1"),n=s("0a49")(5),i="find",c=!0;i in[]&&Array(1)[i]((function(){c=!1})),r(r.P+r.F*c,"Array",{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),s("9c6c")(i)},a502:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-center"},[s("div",{staticClass:"msg-list"},[s("div",{staticClass:"title"},[e._v("\n            訊息列表\n        ")]),e._v("\n        \b"),e._l(e.myExchangeList,(function(t,r){return s("div",{key:r,staticClass:"msg-list-item",class:{active:e.curItem.itemId==t.itemId},on:{click:function(s){return e.selectItem(t)}}},[s("div",{staticClass:"item-name"},[e._l(t.ownMember,(function(t){return s("span",{key:t,staticClass:"member"},[e._v(e._s(t))])})),e._v("\n                換\n                "),e._l(t.targetMember,(function(t,r){return s("span",{key:r,staticClass:"member"},[e._v(e._s(t)+" ")])}))],2),s("p",{staticClass:"summary"},[e._v(e._s(t.desc.length>20?t.desc.slice(0,30)+"...":t.desc))]),s("div",{staticClass:"user"},[e._v("建立者 "+e._s(t.creator))])])}))],2),s("div",{staticClass:"msg-box"},[s("div",{staticClass:"title"},[e._v("\n            "+e._s(e.curMessageList[0].fromUser==e.userName?e.curMessageList[0].toUser:e.curMessageList[0].fromUser)+"\n        ")]),s("div",{staticClass:"msg-detail-container"},e._l(e.curMessageList,(function(t,r){return s("div",{key:r,staticClass:"msg-detail",class:{self:t.fromUser==e.userName}},[s("div",{staticClass:"text"},[e._v(e._s(t.postMessage))]),s("div",{staticClass:"date"},[e._v(e._s(t.create_time))])])})),0),s("div",{staticClass:"msg-send"},[s("el-input",{staticClass:"type-box",attrs:{autosize:"",maxlength:"100",type:"textarea","show-word-limit":"",placeholder:"輸入訊息"},model:{value:e.msgText,callback:function(t){e.msgText=t},expression:"msgText"}}),s("el-button",{staticClass:"btn-send",on:{click:function(t){return e.doSendMessage()}}},[e._v("送出")])],1)]),e._m(0)])},n=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"msg-info"},[s("div",{staticClass:"item-img"})])}],i=(s("8e6e"),s("ac6a"),s("456d"),s("7514"),s("96cf"),s("3b8d")),c=s("bd86"),a=s("2f62"),o=s("c24f"),u=s("a13e");function l(e){return Object(u["a"])({url:"/message/send",method:"post",data:e})}function m(e){return Object(u["a"])({url:"/exchange/messageList",method:"post",data:e})}function f(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function d(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?f(Object(s),!0).forEach((function(t){Object(c["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var g={data:function(){return{myApplyList:[],myExchangeList:[],curItemId:"",curItem:{},msgText:"",curMessageList:[]}},computed:d({},Object(a["c"])({userImg:function(e){return e.user.userImg},userName:function(e){return e.user.userName}})),mounted:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getUserItemList();case 2:this.selectItem(this.myExchangeList[0]);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getUserItemList:function(){var e=this,t={userName:this.$store.state.user.userName,type:"exchange"};return new Promise((function(s,r){Object(o["a"])(t).then((function(t){console.log(t),e.myApplyList=t.body.myApplyList,e.myExchangeList=t.body.myExchangeList,s()})).catch((function(e){console.log(e)}))}))},selectItem:function(e){var t=this;this.curItemId=e.itemId,this.curItem=this.myExchangeList.find((function(e){return e.itemId==t.curItemId})),this.getItemMessage()},getItemMessage:function(){var e=this,t={itemId:this.curItemId};console.log(t),m(t).then((function(t){console.log(t),e.curMessageList=t.messageList})).catch((function(e){console.log(e)}))},doSendMessage:function(){var e=this,t=this.curMessageList[0],s={postMessage:this.msgText,fromUser:this.userName,toUser:t.fromUser!==this.userName?t.fromUser:t.toUser,relatedItem:t.relatedItem};console.log(s),l(s).then((function(t){e.getItemMessage(),e.msgText=""})).catch((function(e){console.log(e)}))}}},h=g,p=(s("2204"),s("2877")),v=Object(p["a"])(h,r,n,!1,null,"13461e23",null);t["default"]=v.exports},cd1c:function(e,t,s){var r=s("e853");e.exports=function(e,t){return new(r(e))(t)}},e853:function(e,t,s){var r=s("d3f4"),n=s("1169"),i=s("2b4c")("species");e.exports=function(e){var t;return n(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!n(t.prototype)||(t=void 0),r(t)&&(t=t[i],null===t&&(t=void 0))),void 0===t?Array:t}}}]);
//# sourceMappingURL=chunk-ec6dae40.70366f5f.js.map